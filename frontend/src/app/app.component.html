<ng-container *ngIf="status$ | async as status">
  <app-loading-spinner *ngIf="status === Status.loading"></app-loading-spinner>
  <div
    *ngIf="zones$ | async as zones"
    class="grid gap-1 full-width full-height"
  >
    <svg
      width="100%"
      height="100%"
      (click)="
        enableAddingNewZone && points.length < 4 && getCoordinates($event)
      "
      [class.cell]="enableAddingNewZone && points.length < 4"
    >
      <polygon
        class="pointer"
        *ngFor="let zone of zones; let i = index"
        (click)="!enableAddingNewZone && (selectedZone = zone)"
        [attr.points]="zone.points | pointsConverter : 10"
        fill="white"
        stroke="black"
        stroke-width="2"
      ></polygon>

      <circle
        *ngFor="let circle of points"
        r="10"
        [attr.cx]="circle![0] * 10"
        [attr.cy]="circle![1] * 10"
        fill="red"
      />

      <text
        *ngFor="let circle of points; let i = index"
        [attr.x]="circle![0] * 10"
        [attr.y]="circle![1] * 10"
        text-anchor="middle"
        stroke="black"
        stroke-width="1px"
        alignment-baseline="middle"
      >
        {{ i + 1 }}
      </text>
    </svg>

    <div class="dashboard">
      <h2>Configuration</h2>
      <button mat-raised-button (click)="onReset()">
        <span *ngIf="!enableAddingNewZone">Add new zone</span>
        <span *ngIf="enableAddingNewZone">Cancel</span>
      </button>
      <br />
      <br />

      <app-new-zone
        *ngIf="enableAddingNewZone"
        [points]="points"
        (addNewZoneHandler)="onAddZoneHandler($event)"
      ></app-new-zone>

      <app-zone-details
        *ngIf="selectedZone"
        [zone]="selectedZone"
        (onDeleteHandler)="onDeleteHandler($event)"
      ></app-zone-details>
    </div>
  </div>
</ng-container>
